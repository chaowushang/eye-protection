# 护眼脚本 (Eye Protection Script)

一款轻量、高效的浏览器护眼扩展脚本。通过将网页原本刺眼的纯白色背景替换为经过调优的舒适色调，有效缓解长时间用眼疲劳。

[![License](https://img.shields.io/badge/license-Apache--2.0-blue.svg)](LICENSE)
[![Version](https://img.shields.io/badge/version-2.0-green.svg)](https://fastly.jsdelivr.net/gh/chaowushang/eye-protection@main/huyan.user.js)

## 🌟 核心功能

*   **智能变色**：精准识别网页中的“大白底”，将其转换为舒适的护眼色，同时保护图片、视频和输入框的原始样式不受影响。
*   **四种主题可选**：
    *   🌾 **乡土黄**：经典纸张质感，适合长时间文字阅读。
    *   🍵 **豆沙绿**：公认最舒适的护眼色，清新自然。
    *   🎨 **浅色灰**：低调简约，适合各类办公与设计类网页。
    *   🍃 **淡橄榄**：温润如玉，减少屏幕蓝光感。
*   **动态内容支持**：采用高性能观察者模式（MutationObserver），完美支持瀑布流网页（如微博、B站、百度搜索结果）的自动变色，无需刷新。
*   **站点黑名单**：通过油猴菜单一键禁用/启用特定网站，灵活管理。
*   **性能优化**：底层基于 CSS 变量与标记算法，占用内存极低，不卡顿。

## 🚀 安装方式

1.  **准备环境**：确保浏览器已安装脚本管理器，如 [Tampermonkey](https://www.tampermonkey.net/)、Violentmonkey 或 GreaseMonkey。
2.  **一键安装**：点击下方链接即可自动弹出安装界面：
    *   👉 [**点击安装护眼脚本**](https://fastly.jsdelivr.net/gh/chaowushang/eye-protection@main/huyan.user.js)
3.  **在线更新**：脚本已配置自动更新地址，后续功能优化将自动同步。

## 🛠 使用说明

安装完成后，点击浏览器右上角的油猴插件图标，在“护眼脚本”菜单下即可进行操作：

*   **切换颜色**：实时预览并切换四种护眼背景色。
*   **在此站启用/禁用**：如果某个网页的样式与脚本冲突，可点击此项将其加入黑名单。
*   **设置永久生效**：脚本会自动记忆你的颜色偏好，跨设备同步（需开启插件同步功能）。

## 📈 更新日志

v2.0 (重大更新)
区域智能锁定：精准识别中间内容区块变色，左右两侧背景严格保持原色。
深度穿透处理：重构 CSS 覆盖逻辑，彻底消除 V2EX、GitHub 等站内部嵌套的白块与细条。
智能色差补偿：支持对非纯白（如浅灰、淡蓝）内容区块的自动识别与适配。
性能深度优化：引入“宽度过滤”算法，大幅降低大规模 DOM 变动时的 CPU 占用。

v1.1
算法优化：改进颜色识别逻辑，提升文字对比度，阅读更清晰。
加载加速：更换国内 CDN 链接，提升脚本加载与更新速度。
站点记忆：支持单站点“启用/禁用”记忆功能，自主控制护眼范围。

v1.0
基础护眼：支持乡土黄、豆沙绿、浅色灰、淡橄榄四种经典护眼色。
颜色记忆：自动保存用户的背景色偏好。
全网适配：基础网页背景颜色智能替换。

## 📄 开源协议

本项目遵循 **Apache-2.0** 协议开源。

## 🤝 贡献与反馈

如果你在使用过程中遇到网页排版错乱、颜色异常等问题，欢迎通过以下方式反馈：
*   在 GitHub 提交 [Issues](https://github.com/chaowushang/eye-protection/issues)
*   通过 GreasyFork 留言

---
**提示**：长时间用眼建议每 45 分钟远眺休息，本工具仅作为辅助手段。
